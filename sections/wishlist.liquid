<section class="section section-{{ section.id }}-padding gradient color-{{ section.settings.color_scheme }}">
  {{ 'component-card.css' | asset_url | stylesheet_tag }}
  <script>
    (function(){
      var KEY='fh_wishlist_v1';
      function get(){try{return JSON.parse(localStorage.getItem(KEY))||[];}catch(e){return [];}}
      function render(ids){
        var root=document.getElementById('wishlist-{{ section.id }}');
        if(!ids.length){root.innerHTML='<p>{{ 'sections.collection_template.empty' | t }}</p>';return;}
        var handle = ids.map(function(id){return 'id:'+id}).join(' OR ');
        fetch('/search?q='+encodeURIComponent(handle)+'&type=product&view=grid')
          .then(function(r){return r.text()}).then(function(html){root.innerHTML=html;document.dispatchEvent(new CustomEvent('wishlist:refresh',{detail:{root:root}}));});
      }
      document.addEventListener('DOMContentLoaded', function(){ render(get()); });
      document.addEventListener('wishlist:updated', function(e){ render(e.detail.ids); });
    })();
  </script>
  <div class="page-width">
    <div class="title-wrapper">
      <h1 class="title {{ section.settings.heading_size }}">{{ section.settings.title }}</h1>
    </div>
    <div id="wishlist-{{ section.id }}"></div>
  </div>
</section>

{% schema %}
{
  "name": "Wishlist",
  "tag": "section",
  "class": "section",
  "settings": [
    { "type": "text", "id": "title", "label": "Heading", "default": "Wunschliste" },
    {
      "type": "select",
      "id": "heading_size",
      "label": "Heading size",
      "default": "h1",
      "options": [
        { "value": "h1", "label": "H1" },
        { "value": "h2", "label": "H2" }
      ]
    },
    { "type": "color_scheme", "id": "color_scheme", "label": "t:sections.all.colors.label", "default": "scheme-1" },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "t:sections.all.padding.padding_top",
      "default": 36
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "t:sections.all.padding.padding_bottom",
      "default": 36
    }
  ],
  "presets": [{ "name": "Wishlist", "category": "Text" }]
}
{% endschema %}
